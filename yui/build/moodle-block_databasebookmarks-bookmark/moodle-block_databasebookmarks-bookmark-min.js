YUI.add("moodle-block_databasebookmarks-bookmark",function(e,t){M.block_databasebookmarks=M.block_databasebookmarks||{},M.block_databasebookmarks.bookmark={init:function(){e.all(".data_bookmark_link").each(function(){var e=this.getAttribute("data-moreurl"),t=e.match(/rid=([0-9])/i)[1];this.setAttribute("data-rid",t),this.setAttribute("data-action","create")}),e.io(M.cfg.wwwroot+"/blocks/databasebookmarks/ajax.php",{method:"POST",data:"action=getids&sesskey="+M.cfg.sesskey,on:{complete:function(t,n){data=e.JSON.parse(n.responseText);for(i=0;i<data.length;i++){var r=data[i];e.all('.data_bookmark_link[data-rid="'+r+'"]').set("text",M.util.get_string("deletebookmark","block_databasebookmarks")),e.all('.data_bookmark_link[data-rid="'+r+'"]').setAttribute("data-action","delete")}}}}),e.one("body").delegate("click",M.block_databasebookmarks.bookmark.handlebookmark,".data_bookmark_link, .data_deletebookmark_link")},handlebookmark:function(t){t.preventDefault();var n=t.currentTarget.getAttribute("data-rid"),r=t.currentTarget.getAttribute("data-action");e.io(M.cfg.wwwroot+"/blocks/databasebookmarks/ajax.php",{method:"POST",data:"rid="+n+"&action="+r+"&sesskey="+M.cfg.sesskey,on:{complete:function(t,i){e.one("ul.block_databasebookmarks_bookmarklist").replace(i.responseText),r=="create"?(e.all('.data_bookmark_link[data-rid="'+n+'"]').set("text",M.util.get_string("deletebookmark","block_databasebookmarks")),e.all('.data_bookmark_link[data-rid="'+n+'"]').setAttribute("data-action","delete")):(e.all('.data_bookmark_link[data-rid="'+n+'"]').set("text",M.util.get_string("bookmark","block_databasebookmarks")),e.all('.data_bookmark_link[data-rid="'+n+'"]').setAttribute("data-action","create"))}}})}}},"@VERSION@",{requires:["node","json"]});
