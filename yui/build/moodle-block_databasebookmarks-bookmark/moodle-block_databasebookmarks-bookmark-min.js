YUI.add("moodle-block_databasebookmarks-bookmark",function(e,t){M.block_databasebookmarks=M.block_databasebookmarks||{},M.block_databasebookmarks.bookmark={updateallbookmarklinks:function(){e.io(M.cfg.wwwroot+"/blocks/databasebookmarks/ajax.php",{method:"POST",data:"action=getids&sesskey="+M.cfg.sesskey,on:{complete:function(t,n){data=e.JSON.parse(n.responseText);for(i=0;i<data.length;i++){var r=data[i];e.all('.data_bookmark_link[data-rid="'+r+'"]').set("text",M.util.get_string("deletebookmark","block_databasebookmarks")),e.all('.data_bookmark_link[data-rid="'+r+'"]').setAttribute("data-action","delete")}}}})},addbookmarktoavailabletags:function(){var t=M.util.get_string("buttons","mod_data"),n=e.one('select#availabletags optgroup[label="'+t+'"]');if(n){var r=M.util.get_string("bookmark","block_databasebookmarks");n.append('<option value="##bookmark##">'+r+" ##bookmark##</span>")}},init:function(){e.all(".data_bookmark_link").each(function(){var e=this.getAttribute("data-moreurl"),t=e.match(/rid=([0-9])/i)[1];this.setAttribute("data-rid",t),this.setAttribute("data-action","create")}),this.updateallbookmarklinks(),this.addbookmarktoavailabletags(),e.one("body").delegate("click",M.block_databasebookmarks.bookmark.handlebookmark,".data_bookmark_link, .data_deletebookmark_link")},handlebookmark:function(t){t.preventDefault();var n=t.currentTarget.getAttribute("data-rid"),r=t.currentTarget.getAttribute("data-action");r=="create"?M.block_databasebookmarks.bookmark.createdialog(n):e.io(M.cfg.wwwroot+"/blocks/databasebookmarks/ajax.php",{method:"POST",data:"rid="+n+"&action=delete&sesskey="+M.cfg.sesskey,on:{complete:function(t,r){e.one("ul.block_databasebookmarks_bookmarklist").replace(r.responseText),e.all('.data_bookmark_link[data-rid="'+n+'"]').set("text",M.util.get_string("bookmark","block_databasebookmarks")),e.all('.data_bookmark_link[data-rid="'+n+'"]').setAttribute("data-action","create")}}})},createdialog:function(t){var n=M.util.get_string("bookmarkname","block_databasebookmarks"),r=M.util.get_string("bookmarkheader","block_databasebookmarks"),i='<label for="bookmarkname_'+t+'">'+n+'</label><input name="bookmarkname_'+t+'" id="bookmarkname_'+t+'"/><div><input type="button" value ="'+r+'" id="btncreatebookmark_'+t+'"/></div>',s=new M.core.dialogue({headerContent:r,bodyContent:i,width:500,zIndex:5,centered:!0,modal:!0,render:!0});s.show();var o="#"+s.get("id")+" #btncreatebookmark_"+t+"",u="#"+s.get("id")+" #bookmarkname_"+t+"";e.one(o).on("click",function(){var n=e.one(u).get("value");e.io(M.cfg.wwwroot+"/blocks/databasebookmarks/ajax.php",{method:"POST",data:"rid="+t+"&action=create&sesskey="+M.cfg.sesskey+"&bookmarkname="+n,on:{complete:function(n,r){e.one("ul.block_databasebookmarks_bookmarklist").replace(r.responseText),e.all('.data_bookmark_link[data-rid="'+t+'"]').set("text",M.util.get_string("deletebookmark","block_databasebookmarks")),e.all('.data_bookmark_link[data-rid="'+t+'"]').setAttribute("data-action","delete"),s.destroy()}}})})}}},"@VERSION@",{requires:["node","json"]});
